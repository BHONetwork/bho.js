"use strict";(self.webpackChunk_bho_network_docs=self.webpackChunk_bho_network_docs||[]).push([[7],{876:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var r=n(2784);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var d=r.createContext({}),l=function(e){var t=r.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=l(e.components);return r.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},p=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,d=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=l(n),m=a,v=p["".concat(d,".").concat(m)]||p[m]||c[m]||i;return n?r.createElement(v,o(o({ref:t},u),{},{components:n})):r.createElement(v,o({ref:t},u))}));function m(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=p;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=e,s.mdxType="string"==typeof e?e:a,o[1]=s;for(var l=2;l<i;l++)o[l]=n[l];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}p.displayName="MDXCreateElement"},4801:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>s,toc:()=>l});var r=n(7896),a=(n(2784),n(876));const i={sidebar_position:4},o="Add liquidity",s={unversionedId:"swap-sdk/getting-started/add-liquidity",id:"swap-sdk/getting-started/add-liquidity",title:"Add liquidity",description:"Determine desired amount",source:"@site/docs/swap-sdk/getting-started/add-liquidity.md",sourceDirName:"swap-sdk/getting-started",slug:"/swap-sdk/getting-started/add-liquidity",permalink:"bho.js/docs/swap-sdk/getting-started/add-liquidity",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/swap-sdk/getting-started/add-liquidity.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Initialize SDK",permalink:"bho.js/docs/swap-sdk/getting-started/initialize-sdk"},next:{title:"Remove liquidity",permalink:"bho.js/docs/swap-sdk/getting-started/remove-liquidity"}},d={},l=[{value:"Determine desired amount",id:"determine-desired-amount",level:2},{value:"Provide liquidity",id:"provide-liquidity",level:2}],u={toc:l};function c(e){let{components:t,...n}=e;return(0,a.kt)("wrapper",(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"add-liquidity"},"Add liquidity"),(0,a.kt)("h2",{id:"determine-desired-amount"},"Determine desired amount"),(0,a.kt)("p",null,"Before providing liquidity, it is important to know what is the current ",(0,a.kt)("a",{parentName:"p",href:"../reference/glossary#mid-price"},"mid price")," of the liquidity pool so that you can determine the desired amount of two tokens to provide liquidity. First, we need to get current liquidity pool reserves."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'// For PSP22 Pair\nconst [reserveA, reserveB] = await sdk.getLiquidityPoolReserves(tokenA, tokenB).unwrapOrThrow();\nconst amountADesired = new BN(1_000);\nconst amountBDesired = amountADesired.mul(reserveA).div(reserveB);\n\n// For BHO-PSP22 Pair\nconst [reserveBHO, reserveB] = await sdk.getLiquidityPoolReserves("BHO", tokenB).unwrapOrThrow();\n')),(0,a.kt)("h2",{id:"provide-liquidity"},"Provide liquidity"),(0,a.kt)("p",null,"SDK supports providing liquidity for a pair of PSP22 tokens. But first, you need to ensure that the SDK (router contract) has permission to spend your tokens on your behalf to the liquidity pool."),(0,a.kt)("p",null,"SDK supplies the API to query the allowance in case you want to check if users already approved the SDK,"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'const tokenAddr = "nvmrRQYzkBScPeWAkGm3HJfvg7XgwsSM2Y3cnz2AaHN2G11AW";\nconst usrAddr = "5GrwvaEF5zXb26Fz9rcQpDWS57CtERHpNehXCPcNoHGKutQY";\n\nconst allowance = (await sdk.getAllowance(tokenAddr, usrAddr)).unwrapOrThrow();\n')),(0,a.kt)("p",null,"Users can approve the SDK by,"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'import { MAX_U128 } from "@bho-network/sdk-swap";\n\nconst tokenAddr = "nvmrRQYzkBScPeWAkGm3HJfvg7XgwsSM2Y3cnz2AaHN2G11AW";\n\n// You can approve any amount here.\n(await sdk.approve(token, MAX_U128)).unwrapOrThrow();\n')),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"It's up to you to supply any allowance. If you approve just a small amount enough for several transactions, you may need to approve multiple times in the future and may cost more transaction fee in the long run. However, it is more secured than just one big approval in case the contract is compromised. Evaluate the trade-off and use with your own risk."))),(0,a.kt)("p",null,"To provide liquidity, you need to provide token ss58 encoded address as well as the desired amount of liquidity that you intent to provide."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'// Amount can be a string, BN, a number or even a hex string.\n// In general, it will accept "like" values of Codec number.\nconst amountA = 10_000;\nconst amountB = "1000";\n\ntry {\n  // `Result` is returned by most of SDK APIs. Please read Basics for more information.\n  const result = await sdk.addLiquidity(tokenA, tokenB, amountA, amountB);\n\n  // Check and log recoverable errors.\n  if (result.hasError()) {\n    console.log(`Add liquidity failed: ${result.error.message}`);\n  }\n} catch (ex: unknown) {\n  // Check and log unexpected errors here\n}\n')),(0,a.kt)("p",null,"To provide liquidity between native BHO token and PSP22 tokens, you can use a special address ",(0,a.kt)("inlineCode",{parentName:"p"},"BHO")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-typescript"},'(await sdk.addLiquidity("BHO", tokenB, amountBHO, amountB)).unwrapOrThrow();\n')),(0,a.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"Executed mid price (mid price when transaction is executed) maybe different from the desired mid price you calculated and supply to the SDK. Due to this, BHO Swap also allows users to specify the limit on the mid price that the users willing to accept, otherwise, the transaction is reverted. Checkout the SDK API Reference for this advanced use-case."))))}c.isMDXComponent=!0}}]);